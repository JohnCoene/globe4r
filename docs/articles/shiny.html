<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>shiny • globe4r</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="shiny">
<meta property="og:description" content="">
<meta property="og:image" content="https://globe4r.john-coene.com/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-74544116-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-74544116-1');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">globe4r</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../LICENSE.html">
    <span class="fa fa-balance-scale fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/">
    <span class="fa fa-code fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/get-started.html">
    <span class="fa fa-rocket fa-lg"></span>
     
    Get Started
  </a>
</li>
<li>
  <a href="../articles/shiny.html">
    <span class="fa fa-desktop fa-lg"></span>
     
    Shiny
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/JohnCoene/globe4r">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>shiny</h1>
            
      
      
      <div class="hidden name"><code>shiny.Rmd</code></div>

    </div>

    
    
<div id="proxies" class="section level2">
<h2 class="hasAnchor">
<a href="#proxies" class="anchor"></a>Proxies</h2>
<p>In globe4r nearly every function is shiny friendly: the vast majority have a <em>proxy</em> method. Let’s a very create a basic application.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(shiny)

ui &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/fluidPage">fluidPage</a></span>(
  <span class="kw"><a href="../reference/globe-shiny.html">globeOutput</a></span>(<span class="st">"globe"</span>)
)

server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output){
  output<span class="op">$</span>globe &lt;-<span class="st"> </span><span class="kw"><a href="../reference/globe-shiny.html">render_globe</a></span>({
    <span class="kw"><a href="../reference/create_globe.html">create_globe</a></span>()
  })
}

<span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/shinyApp">shinyApp</a></span>(ui, server)</code></pre></div>
<p>With our basic shiny application setup we can demonstrate how proxies and their methods work in globe4r. Let’s add a dropdown to allow users to change the globe map.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(shiny)

ui &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/fluidPage">fluidPage</a></span>(
  <span class="kw"><a href="../reference/globe-shiny.html">globeOutput</a></span>(<span class="st">"globe"</span>),
  <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/actionButton">actionButton</a></span>(<span class="st">"draw"</span>, <span class="st">"Draw map"</span>)
)

server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output){
  output<span class="op">$</span>globe &lt;-<span class="st"> </span><span class="kw"><a href="../reference/globe-shiny.html">render_globe</a></span>({
    <span class="kw"><a href="../reference/create_globe.html">create_globe</a></span>()
  })

  <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/observeEvent">observeEvent</a></span>(input<span class="op">$</span>draw, {
    <span class="kw"><a href="../reference/globe-shiny.html">globe_proxy</a></span>(<span class="st">"globe"</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">      </span><span class="kw"><a href="../reference/globe_img.html">globe_img_url</a></span>(<span class="kw"><a href="../reference/image_url.html">image_url</a></span>(<span class="st">"blue"</span>))
  })
}

<span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/shinyApp">shinyApp</a></span>(ui, server)</code></pre></div>
<p>The <code>globe_proxy</code> function creates a “proxy” of our visualisation and enables modifying it in place, without redrawing th entire globe.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(shiny)

df &lt;-<span class="st"> </span>agriland
scale_color &lt;-<span class="st"> </span>scales<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/scales/topics/col_numeric">col_numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"#2c7fb8"</span>, <span class="st">"#7fcdbb"</span>, <span class="st">"#edf8b1"</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">1</span>))
df<span class="op">$</span>color &lt;-<span class="st"> </span><span class="kw">scale_color</span>(df<span class="op">$</span>percent)
df<span class="op">$</span>percent &lt;-<span class="st"> </span>(df<span class="op">$</span>percent <span class="op">/</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="fl">.1</span>

ui &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/fluidPage">fluidPage</a></span>(
  <span class="kw"><a href="../reference/globe-shiny.html">globeOutput</a></span>(<span class="st">"globe"</span>, <span class="dt">height =</span> <span class="dv">500</span>),
  <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/actionButton">actionButton</a></span>(<span class="st">"draw"</span>, <span class="st">"Draw polygons"</span>)
)

server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output){
  output<span class="op">$</span>globe &lt;-<span class="st"> </span><span class="kw"><a href="../reference/globe-shiny.html">render_globe</a></span>({
    <span class="kw"><a href="../reference/create_globe.html">create_globe</a></span>()
  })

  <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/observeEvent">observeEvent</a></span>(input<span class="op">$</span>draw, {
    <span class="kw"><a href="../reference/globe-shiny.html">globe_proxy</a></span>(<span class="st">"globe"</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">      </span><span class="kw"><a href="../reference/globe_choropleth.html">globe_choropleth</a></span>(
        <span class="dt">data =</span> df,
        <span class="kw"><a href="../reference/coords.html">coords</a></span>(
          <span class="dt">country =</span> country_code,
          <span class="dt">altitude =</span> percent,
          <span class="dt">cap_color =</span> color
        )
      )
  })
}

<span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/shinyApp">shinyApp</a></span>(ui, server)</code></pre></div>
</div>
<div id="events" class="section level2">
<h2 class="hasAnchor">
<a href="#events" class="anchor"></a>Events</h2>
<p>You can also pick up callback events: how users interacti with you globe visualisation. Every globe layer (hex bin, points, labels, arcs, choropleth), can send data information on element clicked, right clicked, or hovered. These can be accessed in the R server like a normal input which you construct from the <code>id</code> of the globe visualisation you want to watch and the event you want to catch, e.g.: <code>input$myGlobe_click_bar</code>, or <code>input$myOtherGlobe_hover_arc</code>, note that you capture events related to <code>globe_chorpleth</code> with <code>*_polygon</code>, e.g.: <code>input$theGlobeId_right_click_polygon</code>.</p>
<p>Events:</p>
<ul>
<li>Clicked - check whether the element has been clicked (<code>_click_bar</code>, <code>_click_label</code>, <code>_click_polygon</code>, <code>_click_hex</code>, <code>_click_arc</code>).</li>
<li>Right Clicked - check whether the element has been right clicked (<code>_right_click_bar</code>, <code>_right_click_label</code>, <code>_right_click_polygon</code>, <code>_right_click_hex</code>, <code>_right_click_arc</code>).</li>
<li>Hovered - check whether the element has been hovered (<code>_hover_bar</code>, <code>_hover_label</code>, <code>_hover_polygon</code>, <code>_hover_hex</code>, <code>_hover_arc</code>).</li>
</ul>
<p>Examples, where <code>globeId</code> is the id of the globe.</p>
<ul>
<li>
<code>input$globeId_click_bar</code> will return data on bar clicked by the user.</li>
<li>
<code>input$globeId_hover_hex</code> will return data on hex bin hovered.</li>
<li>
<code>input$globeId_right_click_polygon</code> will return data on polygon right clicked.</li>
</ul>
<p>Note that these are not enabled by default as it can be draining on the client/server as you send data from the client to the server, you enable it in the various <code>globe_*</code> functions by setting <code>on_click</code>, <code>on_right_click</code>, or <code>on_hover</code> to <code>TRUE</code>. Let’s demonstrate with a shiny app. Below we have a bog standard shiny application that draws our globe.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(shiny)

ui &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/fluidPage">fluidPage</a></span>(
  <span class="kw"><a href="../reference/globe-shiny.html">globeOutput</a></span>(<span class="st">"globe"</span>)
)

server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output){
  output<span class="op">$</span>globe &lt;-<span class="st"> </span><span class="kw"><a href="../reference/globe-shiny.html">renderGlobe</a></span>({
    <span class="kw"><a href="../reference/create_globe.html">create_globe</a></span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">      </span><span class="kw"><a href="../reference/globe_img.html">globe_img_url</a></span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">      </span><span class="kw"><a href="../reference/globe_bars.html">globe_bars</a></span>(<span class="kw"><a href="../reference/coords.html">coords</a></span>(lat, long, <span class="dt">color =</span> mag), <span class="dt">data =</span> quakes) <span class="op">%&gt;%</span>
<span class="st">      </span><span class="kw"><a href="../reference/globe_pov.html">globe_pov</a></span>(<span class="op">-</span><span class="dv">21</span>, <span class="dv">179</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">      </span><span class="kw"><a href="../reference/scaling_color.html">scale_bars_color</a></span>()
  })
}

<span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/shinyApp">shinyApp</a></span>(ui, server)</code></pre></div>
<p>We can now use events to capture which bar the user clicked, notice the <code>on_click = TRUE</code> in <code>globe_bars</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(shiny)

ui &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/fluidPage">fluidPage</a></span>(
  <span class="kw"><a href="../reference/globe-shiny.html">globeOutput</a></span>(<span class="st">"globe"</span>),
  <span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/verbatimTextOutput">verbatimTextOutput</a></span>(<span class="st">"clicked"</span>)
)

server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output){
  output<span class="op">$</span>globe &lt;-<span class="st"> </span><span class="kw"><a href="../reference/globe-shiny.html">renderGlobe</a></span>({
    <span class="kw"><a href="../reference/create_globe.html">create_globe</a></span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">      </span><span class="kw"><a href="../reference/globe_img.html">globe_img_url</a></span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">      </span><span class="kw"><a href="../reference/globe_bars.html">globe_bars</a></span>(<span class="kw"><a href="../reference/coords.html">coords</a></span>(lat, long, <span class="dt">color =</span> mag), 
        <span class="dt">data =</span> quakes, <span class="dt">on_click =</span> <span class="ot">TRUE</span> <span class="co"># set on_click to TRUE</span>
      ) <span class="op">%&gt;%</span>
<span class="st">      </span><span class="kw"><a href="../reference/globe_pov.html">globe_pov</a></span>(<span class="op">-</span><span class="dv">21</span>, <span class="dv">179</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">      </span><span class="kw"><a href="../reference/scaling_color.html">scale_bars_color</a></span>()
  })

  output<span class="op">$</span>clicked &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/renderPrint">renderPrint</a></span>({
    input<span class="op">$</span>globe_click_bar
  })
}

<span class="kw"><a href="https://www.rdocumentation.org/packages/shiny/topics/shinyApp">shinyApp</a></span>(ui, server)</code></pre></div>
<p>Note that we simply print the information returned by the event but ideally you would do something interesting with it.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#proxies">Proxies</a></li>
      <li><a href="#events">Events</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="http://john-coene.com">John Coene</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
